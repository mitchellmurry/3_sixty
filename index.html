<!DOCTYPE html>
<html lang="en">
  <head>
    <title>3_Sixty Animation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
      body {
        background-color: #ffffff;
        margin: 0px;
        overflow: hidden;
      }

      a {
        color:#0078ff;
      }
    </style>
  </head>
  <body>

    <script src="js/three.min.js"></script>
    <script src="js/libs/dat.gui.min.js"></script>
    <script src="js/libs/stats.min.js"></script>

    <script src="js/controls/OrbitControls.js"></script>
    <script src="js/renderers/Projector.js"></script>
    <script src="js/renderers/CanvasRenderer.js"></script>

    <script>
     var renderer, scene, camera, controls, particle;

var particles = []
var speeds = []
var meshs = []
var PARTICLE_COUNT = 8;

init();
animate();

function init() {

  // renderer
  renderer = new THREE.WebGLRenderer( { antialias: true } );
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( window.innerWidth, window.innerHeight );
  renderer.setClearColor(0xffffff, 1)
  document.body.appendChild( renderer.domElement );

  // scene
  scene = new THREE.Scene();

  // camera
  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
  camera.position.set(0, 0, 50);

  // controls
  controls = new THREE.OrbitControls( camera );
  controls.minDistance = 10;
  controls.maxDistance = 100;

  // axes
  scene.add( new THREE.AxisHelper( 1 ));

  // empty each time we init (in case we change anything in the sliders)
  paths = []
  speeds = []
  colors = [0x009ee3, 0xdedc00, 0xe94e1c]
  


  for (var i = 0; i < PARTICLE_COUNT; i++) {
    function Ellipse(rad, e) {
      THREE.Curve.call(this);
      this.radius = rad
      this.end = e
    }

    Ellipse.prototype = Object.create( THREE.Curve.prototype );
    Ellipse.prototype.constructor = Ellipse;

    // define the getPoint function for the subClass
    Ellipse.prototype.getPoint = function ( t ) {
      var radians = this.end * t;

      return new THREE.Vector3(this.radius * Math.cos( radians ),
                               this.radius * Math.sin( radians ),
                               0);
    };
    
    var path = new THREE.Group();   
    
    var color = colors[i % colors.length]
    var material = new THREE.MeshBasicMaterial({ color: color });
    var tubeThickness = 0.5
    
    var radius = 10 + Math.random() * 10
    var rotation = new THREE.Vector3(
      2 * Math.PI * Math.random(), 
      2 * Math.PI * Math.random(), 
      0
    )
      
    var arc = Math.PI / 6 + (Math.random() * Math.PI / 6)

    var geometry = new THREE.TubeGeometry(
      new Ellipse(radius, arc), 
      100, 
      tubeThickness, 
      20, 
      false
    );
    var mesh = new THREE.Mesh(geometry, material);
    
    var startBall = new THREE.SphereGeometry(tubeThickness, 32, 32 );
    var startBallMesh = new THREE.Mesh(startBall, material);
    startBallMesh.position.x = radius

    var endBall = new THREE.SphereGeometry(tubeThickness, 32, 32 );
    var endBallMesh = new THREE.Mesh(endBall, material);
    endBallMesh.position.x = radius * Math.cos(arc)
    endBallMesh.position.y = radius * Math.sin(arc)

    path.add(mesh)
    path.add(startBallMesh)
    path.add(endBallMesh)

    path.rotation.x = rotation.x;
    path.rotation.y = rotation.y;
      
    var speed = new THREE.Vector3(
      0, 
      0, 
      Math.random() * 0.02 + 0.005
    )
      
      scene.add(path);
      
      paths.push(path)
      speeds.push(speed)
    }   

  }   


    function animate() {
      requestAnimationFrame( animate );

      for (var i = 0; i < paths.length; i++) {
        // get the group from the particles array
        var path = paths[i]
        
        // get the speed of rotation from the speeds array
        var speed = speeds[i]
        
        path.rotation.x += speed.x;
        path.rotation.y += speed.y;
        path.rotation.z += speed.z;
      }

      renderer.render( scene, camera );

    }


    </script>
  </body>
</html>